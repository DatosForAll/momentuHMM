% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/getHierParDM.R
\name{getHierParDM}
\alias{getHierParDM}
\title{Get hierarchical HMM starting values on working scale based on design matrix and other parameter constraints}
\usage{
getHierParDM(data = data.frame(), hierStates, hierDist, Par,
  zeroInflation = NULL, oneInflation = NULL, estAngleMean = NULL,
  circularAngleMean = NULL, DM = NULL, userBounds = NULL,
  workBounds = NULL)
}
\arguments{
\item{data}{Optional \code{\link{momentuHierHMMData}} object or a data frame containing the covariate values. 
\code{data} must be specified if covariates are included in \code{DM}.}

\item{hierStates}{A hierarchical model structure \code{\link[data.tree]{Node}} for the states.  See \code{\link{fitHierHMM}}.}

\item{hierDist}{A hierarchical data structure \code{\link[data.tree]{Node}} for the data streams. See \code{\link{fitHierHMM}}.}

\item{Par}{A named list containing vectors of state-dependent probability distribution parameters for 
each data stream specified in \code{hierDist}. The parameters should be on the natural scale,
in the order expected by the pdfs of \code{hierDist}, and any zero-mass parameters should be the last.}

\item{zeroInflation}{A named list of logicals indicating whether the probability distributions of the data streams should be zero-inflated. If \code{zeroInflation} is \code{TRUE} 
for a given data stream, then values for the zero-mass parameters should be
included in the corresponding element of \code{Par}. Ignored if \code{data} is a \code{\link{momentuHierHMMData}} object.}

\item{oneInflation}{Named list of logicals indicating whether the probability distributions of the data streams are one-inflated. If \code{oneInflation} is \code{TRUE} 
for a given data stream, then values for the one-mass parameters should be
included in the corresponding element of \code{Par}. Ignored if \code{data} is a \code{\link{momentuHierHMMData}} object.}

\item{estAngleMean}{An optional named list indicating whether or not to estimate the angle mean for data streams with angular 
distributions ('vm' and 'wrpcauchy'). Any \code{estAngleMean} elements corresponding to data streams that do not have angular distributions are ignored.}

\item{circularAngleMean}{An optional named list indicating whether to use circular-linear or circular-circular 
regression on the mean of circular distributions ('vm' and 'wrpcauchy') for turning angles.  See \code{\link{fitHierHMM}}. \code{circularAngleMean} elements corresponding to angular data 
streams are ignored unless the corresponding element of \code{estAngleMean} is \code{TRUE}. Any \code{circularAngleMean} elements 
corresponding to data streams that do not have angular distributions are ignored.}

\item{DM}{A named list indicating the design matrices to be used for the probability distribution parameters of each data 
stream. Each element of \code{DM} can either be a named list of linear regression formulas or a matrix.  For example, for a 2-state 
model using the gamma distribution for a data stream named 'step', \code{DM=list(step=list(mean=~cov1, sd=~1))} specifies the mean 
parameters as a function of the covariate 'cov1' for each state.  This model could equivalently be specified as a 4x6 matrix using 
character strings for the covariate: 
\code{DM=list(step=matrix(c(1,0,0,0,'cov1',0,0,0,0,1,0,0,0,'cov1',0,0,0,0,1,0,0,0,0,1),4,6))}
where the 4 rows correspond to the state-dependent paramaters (mean_1,mean_2,sd_1,sd_2) and the 6 columns correspond to the regression 
coefficients.}

\item{userBounds}{An optional named list of 2-column matrices specifying bounds on the natural (i.e, real) scale of the probability 
distribution parameters for each data stream. For example, for a 2-state model using the wrapped Cauchy ('wrpcauchy') distribution for 
a data stream named 'angle' with \code{estAngleMean$angle=TRUE)}, \code{userBounds=list(angle=matrix(c(-pi,-pi,-1,-1,pi,pi,1,1),4,2))} 
specifies (-1,1) bounds for the concentration parameters instead of the default [0,1) bounds.}

\item{workBounds}{An optional named list of 2-column matrices specifying bounds on the working scale of the probability distribution, transition probability, and initial distribution parameters. For each matrix, the first column pertains to the lower bound and the second column the upper bound.
For data streams, each element of \code{workBounds} should be a k x 2 matrix with the same name of the corresponding element of 
\code{Par0}, where k is the number of parameters. For transition probability parameters, the corresponding element of \code{workBounds} must be a k x 2 matrix named ``beta'', where k=\code{length(beta0)}. For initial distribution parameters, the corresponding element of \code{workBounds} must be a k x 2 matrix named ``delta'', where k=\code{length(delta0)}.}
}
\value{
A list of parameter values that can be used as starting values (\code{Par0}) in \code{\link{fitHierHMM}} or \code{\link{MIfitHierHMM}}
}
\description{
Convert hierarchical HMM starting values on the natural scale of data stream probability distributions to
a feasible set of working scale parameters based on a design matrix and other parameter constraints.
}
\details{
If design matrix includes non-factor covariates, then natural scale parameters are assumed to correspond to the 
mean value(s) for the covariate(s) (if \code{nrow(data)>1}) and \code{getParDM} simply returns one possible solution to the 
system of linear equations defined by \code{Par}, \code{DM}, and any other constraints using singular value decomposition. 
This can be helpful for exploring relationships between the natural and working scale parameters when covariates are included, but \code{getParDM}
will not necessarily return ``good'' starting values (i.e., \code{Par0}) for \code{\link{fitHierHMM}} or \code{\link{MIfitHierHMM}}.
}
\seealso{
\code{\link{getPar}}, \code{\link{getPar0}}, \code{\link{fitHierHMM}}, \code{\link{MIfitHierHMM}}
}
